# KotobaTranscriber AGEC版 使用方法

AGEC株式会社向けにカスタマイズされたKotobaTranscriberの使用方法を説明します。

## 目次

1. [はじめに](#はじめに)
2. [主な機能](#主な機能)
3. [インストール](#インストール)
4. [基本操作](#基本操作)
5. [会議モード](#会議モード)
6. [議事録生成](#議事録生成)
7. [建設業用語辞書](#建設業用語辞書)
8. [エクスポート機能](#エクスポート機能)
9. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

KotobaTranscriber AGEC版は、建設業・コンストラクションマネジメント（CM）業務に特化した音声認識・議事録生成ツールです。

### AGEC版の特徴

- **建設業用語辞書**: 標準労務費、建設業法、コスト管理用語に対応
- **会議モード**: 長時間会議の自動分割・保存
- **議事録自動生成**: アクションアイテム・決定事項の自動抽出
- **AGEC社内テンプレート**: Excel/Word出力対応

---

## 主な機能

| 機能 | 説明 |
|------|------|
| 🎤 会議モード | 長時間録音の自動分割・保存 |
| 📝 書き起こし | 高精度な音声認識（Kotoba-Whisper） |
| 📋 議事録生成 | 自動分類（決定事項/確認事項/アクション） |
| 📊 Excel出力 | AGEC社内テンプレート対応 |
| 📝 Word出力 | フォーマット済み議事録 |
| 📚 建設業用語 | 専門用語の高精度認識 |

---

## インストール

### 必要条件

- Windows 10/11
- Python 3.9以上
- CUDA対応GPU（推奨）

### セットアップ

```bash
# リポジトリのクローン
cd F:\KotobaTranscriber

# 仮想環境の有効化
.\venv\Scripts\activate

# 必要パッケージのインストール
pip install -r requirements.txt

# 追加パッケージ（エクスポート用）
pip install openpyxl python-docx

# 起動
python src/ui/main_window.py
```

### 簡易起動

```bash
# バッチファイルを使用
start.bat
```

---

## 基本操作

### 1. 音声ファイルから書き起こし

1. 「📂 音声ファイルを選択」ボタンをクリック
2. 音声ファイル（.wav, .mp3, .m4a等）を選択
3. 「📝 書き起こし実行」ボタンをクリック
4. 進捗バーで処理状況を確認
5. 結果が右側のプレビューに表示

### 2. リアルタイム書き起こし

1. 「🎤 リアルタイム」タブを選択
2. マイクを選択
3. 「開始」ボタンをクリック
4. 話した内容がリアルタイムで表示

---

## 会議モード

長時間の会議録音に最適化された機能です。

### 開始方法

1. 会議名を入力（例：「新規店舗開発会議」）
2. 「🔴 録音開始」ボタンをクリック
3. 録音中は「🔴 録音中」と表示
4. 経過時間がリアルタイムで表示

### 自動機能

- **自動分割**: 30分ごとに自動的にファイルを分割
- **自動保存**: 5分ごとにバックアップ保存
- **話者検出**: 複数話者の自動識別

### 停止と処理

1. 「⏹ 録音停止」ボタンをクリック
2. 自動的に書き起こし処理が開始
3. 議事録生成ボタンで議事録を作成

### 録音ファイルの保存場所

```
recordings/meetings/
├── YYYYMMDD_HHMMSS_metadata.json  # メタデータ
├── YYYYMMDD_HHMMSS_seg001.wav     # セグメント1
├── YYYYMMDD_HHMMSS_seg002.wav     # セグメント2
└── ...
```

---

## 議事録生成

### 自動生成手順

1. 書き起こしが完了している状態で
2. 「📄 議事録を生成」ボタンをクリック
3. 自動的に以下を分類：
   - **決定事項**: 「〜決定」「〜確定」等の表現
   - **確認事項**: 「〜確認」等の表現
   - **アクションアイテム**: 「〜する」「〜お願い」等の表現

### 抽出される情報

| 項目 | 説明 | 例 |
|------|------|-----|
| 決定事項 | 決定・確定・採用等 | 外壁材はタイルに決定 |
| 確認事項 | 確認・検証等 | 予算について確認 |
| アクションアイテム | TODO項目 | 佐藤さんが調整を担当 |
| 担当者 | 〜さん/様 | 佐藤、山田等 |
| 期限 | 日付表現 | 来週金曜日、2/10等 |

### プレビュー切り替え

- 「📝 書き起こし」ボタン: 原文表示
- 「📋 議事録」ボタン: 整形済み議事録表示

---

## 建設業用語辞書

AGEC業務に必要な専門用語を事前登録しています。

### 対応用語カテゴリ

#### 1. 標準労務費関連
- 職種：普通作業員、型枠大工、鉄筋工、コンクリート工等
- 賃金：基準内賃金、諸手当、社会保険料等
- 時間：所定労働時間、残業時間、36協定等

#### 2. 建設業法関連
- 法令：建築基準法、建築確認、消防法等
- 工事：建築工事、土木工事、電気工事等
- 設計：基本設計、実施設計、積算書等

#### 3. コスト管理関連
- 積算：単価、数量、原価積算、見積等
- 購買：発注、納品、検収、在庫管理等
- 外注：協力業者、契約単価、出来高単価等

#### 4. AGEC社内用語
- CM：コンストラクションマネジメント、設計監理等
- 店舗：飲食店、クリニック、コンビニ等業種
- 業務：出店支援、店舗開発、プロジェクト管理等

### 辞書のカスタマイズ

```python
# 用語の追加
from src.custom_dictionary import get_custom_dictionary

dict = get_custom_dictionary()
dict.add_term("新しい用語", category="custom")

# 置換ルールの追加
dict.add_replacement("誤認識", "正しい表記")
```

### 辞書ファイルの場所

```
data/construction_dictionary.json
```

---

## エクスポート機能

### Excel出力（.xlsx）

AGEC社内テンプレート形式で出力：

1. 「📊 Excel出力」ボタンをクリック
2. 保存先を選択
3. 以下の形式で出力：
   - タイトル・日時・場所
   - 出席者リスト
   - 議題
   - 決定事項（グレー背景）
   - 確認事項（黄色背景）
   - アクションアイテム（緑背景）
   - 議事内容（話者別）

### Word出力（.docx）

フォーマット済み文書で出力：

1. 「📝 Word出力」ボタンをクリック
2. 保存先を選択
3. 以下の形式で出力：
   - 表形式のヘッダー情報
   - チェックボックス付きアクションアイテム
   - 色分けされた決定/確認事項

### テキスト/Markdown出力

- 「📄 テキスト出力」: プレーンテキスト
- 「📝 Markdown出力」: GitHub Flavored Markdown

---

## トラブルシューティング

### 起動時のエラー

| 症状 | 解決策 |
|------|--------|
| ModuleNotFoundError | `pip install -r requirements.txt` を実行 |
| CUDAエラー | GPUメモリ不足。CPUモードで試行 |
| yamlエラー | `pip install pyyaml` を実行 |

### 認識精度が低い場合

1. **マイク品質の確認**: ノイズキャンセリング搭載マイク推奨
2. **話者の明確化**: 複数人が同時に話さない
3. **専門用語の追加**: 辞書に用語を追加

### エクスポートできない場合

```bash
# 必要パッケージをインストール
pip install openpyxl python-docx
```

### 会議モードで録音されない

1. マイクの権限確認（Windows設定）
2. デフォルトマイクの確認
3. ボリュームレベルの確認

---

## 設定ファイル

### config.yaml の主要設定

```yaml
# 建設業用語辞書
construction_vocabulary:
  enabled: true
  file: "data/construction_dictionary.json"
  categories:
    - standard_labor
    - construction_law
    - cost_management
    - agec_specific

# 会議モード
meeting_mode:
  enabled: true
  auto_split_duration: 1800  # 30分で自動分割
  speaker_detection:
    enabled: true
    min_speakers: 2
    max_speakers: 10
```

---

## サポート

問題が解決しない場合は、以下を確認してください：

1. ログファイル: `logs/app.log`
2. 設定ファイル: `config/config.yaml`
3. 録音ファイル: `recordings/meetings/`

---

**バージョン**: 1.0.0  
**最終更新**: 2026年2月3日  
**作成**: AGEC株式会社
